###### LIBRARIES #####
library(ggstatsplot)
##### PLOT WITH TREE #####
library(phytools)
library(ggtree)
#Read in tree and format a species name
species_tree <- read.tree("~/tree_calibration/congr_sp_tree.dated.tre")
species_tree$tip.label[species_tree$tip.label == "Strongylocentrotus_franciscanus"] <- "Mesocentrotus_franciscanus"
species_tree$tip.label[species_tree$tip.label == "Hypsibius_dujardini"] <- "Hypsibius_exemplaris"
species_tree$tip.label <- str_replace_all(species_tree$tip.label, "_", " ")
p <- ggtree(species_tree, ladderize = T) +
geom_tiplab() +
theme_tree2() +
xlim(c(-10, 1300)) +
theme(text = element_text(size = 18))
p
tree <- ggtree(species_tree, ladderize = T)
df_summary$species <- factor(df_summary$species, levels = rev(species_tree$tip.label))
p1 <- df_summary %>%
pivot_longer(Degraded:Reference) %>%
filter(variable %in% c("Mean 3' UTR Length", 'Total CDS Length')) %>%
rename("Category" = 3) %>%
mutate(Category = str_replace_all(Category, " ", "\n")) %>%
ggplot(aes(x = value, y = species, color = Category)) +
geom_point(alpha = 0.8, size = 5) +
theme_bw() +
scale_color_manual(values = c("#003f5c", "#bc5090", "#31a354")) +
facet_wrap(~variable, scales = 'free_x') +
ylab(NULL) +
xlab("nt length") +
theme(text = element_text(size = 22),
axis.text.y = element_text(size = 15, hjust = 0.5),
axis.text.x = element_text(size = 22),
legend.position = c(0.9, 0.85),
strip.background=element_rect(fill="white"),
legend.box.background = element_rect(colour = "black"))
patch1 <- wrap_elements(tree + p1 + plot_layout(widths = c(1, 8)))
patch1
p2 <- df_summary %>%
pivot_longer(Degraded:Reference) %>%
filter(variable %in% c("Proportion 3' UTR Length", 'Proportion CDS Length')) %>%
ggplot(aes(x = value*100, y = species, color = name)) +
geom_point(alpha = 0.8, size = 5) +
theme_bw() +
scale_color_manual(values = c("#003f5c", "#bc5090", "#31a354")) +
facet_wrap(~variable, scales = 'free_x') +
ylab(NULL) +
xlab("% of total length") +
theme(text = element_text(size = 22),
axis.text.y = element_text(size = 15, hjust = 0.5),
axis.text.x = element_text(size = 22),
legend.position = "none",
strip.background=element_rect(fill="white"))
patch2 <- wrap_elements(tree + p2 + plot_layout(widths = c(1, 8)))
patch2
patch1 / patch2 + plot_annotation(tag_levels = "A")
##### READ IN #####
#Excludingsome species which do not contain informations of UTRs
#Using GTF annotations to extract feature lengths
files <- list.files(path = "~/Documents/Gene_expr_evol/Gene_exprs_modelling_2023/Feature_length/Gene_models/", pattern = "*\\.g.f*", full.names = T)
#Need crossreference table for gene  and transcript IDs
tx2genes_paths <- list.files(path = "~/Documents/Gene_expr_evol/Gene_exprs_modelling_2023/Feature_length/Gene_models/", pattern = "*tsv", full.names = T)
#Read in transcript to gene crossreferences in a loop
tx2genes <- vector(mode = "list", length = length(files))
for(i in 1:length(tx2genes_paths)){
tx2genes[[i]] <- read.table(tx2genes_paths[i], header = F)
names(tx2genes)[i] <- str_remove_all(basename(tx2genes_paths)[i], "_tx2gene\\.tsv$")
}
library(tidyverse)
